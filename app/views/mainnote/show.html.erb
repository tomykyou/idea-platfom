<%= link_to "New Article", new_mainnote_path %>
<%= link_to "マイページへ", mainnnote_mypage_path %>
<%= link_to "このサイトについて", mainnnote_about_path %>
<%= link_to "投稿者一覧へ", mainnnote_usershow_path %>
<%= link_to "ログアウト", destroy_user_session_path, method: :delete %>

<h1><%=@mainnote.title%></h1>

<% @user_mainnote.each do |user| %>
  <p><%= user.username %></p>
  <img src=<%= user.image %> width="100" height="60">
<% end %>

<p><%=safe_join(@mainnote.text.split("\n"),tag(:br))%></p>
  
  <%if @mainnote.image1.blank? %>
    <img src="/assets/Noimage.png" width="100" height="60">
  <% else %>
    <img src=<%= @mainnote.image1 %> width="100" height="60">
  <%end %>
  
  <%if @mainnote.image2.blank? %>
    <img src="/assets/Noimage.png" width="100" height="60">
  <% else %>
    <img src=<%= @mainnote.image2 %> width="100" height="60">
  <%end %>
  
  <%if @mainnote.image3.blank?%>
    <img src="/assets/Noimage.png" width="100" height="60">
  <% else %>
    <img src=<%= @mainnote.image3 %> width="100" height="60">
  <%end %>

<% future_point=0%>
<% surprisingly_point=0%>
<% realization_point=0%>

<% @notecomment.each do |notecomment| %>
  <%future_point+=notecomment.future_point%>
  <%surprisingly_point+=notecomment.surprisingly_point%>
  <%realization_point+=notecomment.realization_point%>
<% end %>

<h3>これまでの獲得ポイント</h3>
<strong>将来性</strong>
<p><%=future_point%><p>
<strong>意外性</strong>
<p><%=surprisingly_point%><p>
<strong>実現性</strong>
<p><%=realization_point%><p>

<!--ログインしているユーザーのみに更新削除をできるように設定。コントローラーでもできるが、ボタンを表示させたくないのでviewで条件を設定。-->
<% if @mainnote.user_id == current_user.id %>
  <ul>
    <li><%= link_to "Edit", edit_mainnote_path(@mainnote) %></li>
    <li><%= link_to "Destroy", mainnote_path(@mainnote),
                    method: :delete,
                    data: { confirm: "Are you sure?" } %></li>
  </ul>
<% end %>

<h2>Comments</h2>
<%= render "notecomments/comment" %>

<!--コメントをしているかどうかの判定。rubyにはboolen型がないので文字列で判定をさせる。-->
<%boolen='true'%>
<% @notecomment.each do |notecomment| %>
  <% if notecomment.user_id == current_user.id%>
    <%boolen='あなたはこのアイデアへ既に評価を投稿しています'%>       
  <% end %>
<% end %>

<% if @mainnote.user_id == current_user.id%>
  <%boolen='自身のアイデアへ評価できません'%>
<%end%>

<%if boolen=='true'%>
  <%= render "notecomments/form" %>
<%else%>
  <p><%=boolen%></p>
<%end%>
