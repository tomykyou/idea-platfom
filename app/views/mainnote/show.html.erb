<h1>IDEA FACTORY</h1>
<nav id="menuber">
  <ul class="menu-text">
    <li><%= link_to 'HOME', root_path %></li>
    <li><%= link_to "MAKE NEW IDEA", new_mainnote_path %></li>
    <li><%= link_to "MYPAGE", mainnnote_mypage_path %></li>
    <li><%= link_to "ABOUT IDEA FACTORY", mainnnote_about_path %></li>
    <li><%= link_to "USER LIST", mainnnote_usershow_path %></li>
    <li><%= link_to "LOGOUT", destroy_user_session_path, method: :get %></li>
  </ul>
</nav>

<h1><%=@mainnote.title%></h1>
<% @user_mainnote.each do |user| %>
  <p><%= user.username %></p>
  <img src=<%= user.image %> width="100" height="60">
<% end %>
<% if @mainnote.user_id == current_user.id %>
    <%= link_to "このアイデアを更新", edit_mainnote_path(@mainnote) %>
    <%= link_to "このアイデアを削除", mainnote_path(@mainnote),
                    method: :delete,
                    data: { confirm: "本当に削除しますか?" } %>

 <%end%> 
<p><%=safe_join(@mainnote.text.split("\n"),tag(:br))%></p>
  <%if @mainnote.image1.blank? %>
    <img src="/assets/Noimage.png" width="200" height="120">
  <% else %>
    <img src=<%= @mainnote.image1 %> width="200" height="120">
  <%end %>
  
  <%if @mainnote.image2.blank? %>
    <img src="/assets/Noimage.png" width="200" height="120">
  <% else %>
    <img src=<%= @mainnote.image2 %> width="200" height="120">
  <%end %>
  
  <%if @mainnote.image3.blank?%>
    <img src="/assets/Noimage.png" width="200" height="120">
  <% else %>
    <img src=<%= @mainnote.image3 %> width="200" height="120">
  <%end %>
<!--ログインしているユーザーのみに更新削除をできるように設定。コントローラーでもできるが、ボタンを表示させたくないのでviewで条件を設定。-->
<% future_point=0%>
<% surprisingly_point=0%>
<% realization_point=0%>

<% @notecomment.each do |notecomment| %>
  <%future_point+=notecomment.future_point%>
  <%surprisingly_point+=notecomment.surprisingly_point%>
  <%realization_point+=notecomment.realization_point%>
<% end %>

<h3>獲得ポイント</h3>
<strong>将来性</strong>
<p><%=future_point%>ポイント<p>
<strong>意外性</strong>
<p><%=surprisingly_point%>ポイント<p>
<strong>実現性</strong>
<p><%=realization_point%>ポイント<p>

<h2>コメント一覧</h2>
<%= render "notecomments/comment" %>

<!--コメントをしているかどうかの判定。rubyにはboolen型がないので文字列で判定をさせる。-->
<%boolen='true'%>
<% @notecomment.each do |notecomment| %>
  <% if notecomment.user_id == current_user.id%>
    <%boolen='あなたは既にこのアイデアへ評価を投稿しています'%>       
  <% end %>
<% end %>

<% if @mainnote.user_id == current_user.id%>
  <%boolen='自身のアイデアへ評価できません'%>
<%end%>

<%if boolen=='true'%>
  <%= render "notecomments/form" %>
<%else%>
  <p><%=boolen%></p>
<%end%>
